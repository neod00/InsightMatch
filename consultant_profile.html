<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>컨설턴트 프로필 - InsightMatch</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Pretendard:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
    <style>
        .profile-container {
            padding-top: 120px;
            padding-bottom: 80px;
        }
        
        .profile-layout {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 32px;
            align-items: start;
        }
        
        @media (max-width: 1024px) {
            .profile-layout {
                grid-template-columns: 1fr;
            }
            
            .profile-sidebar {
                position: static !important;
            }
        }
        
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--text-muted);
            text-decoration: none;
            font-size: 0.9rem;
            margin-bottom: 24px;
            transition: var(--transition-fast);
        }
        
        .back-link:hover {
            color: var(--primary);
        }
        
        .profile-loading {
            text-align: center;
            padding: 80px 40px;
        }
        
        .certification-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }
        
        .certification-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 16px;
            background: var(--bg-secondary);
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
        }
        
        .certification-item i {
            color: var(--primary);
        }
        
        .certification-item span {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .review-card {
            padding: 20px;
            background: var(--bg-secondary);
            border-radius: var(--radius-sm);
            margin-bottom: 16px;
        }
        
        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .review-rating {
            display: flex;
            gap: 4px;
        }
        
        .review-rating i {
            width: 16px;
            height: 16px;
            color: #f59e0b;
        }
        
        .review-content {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
        }
        
        .review-meta {
            margin-top: 12px;
            font-size: 0.85rem;
            color: var(--text-muted);
        }
    </style>
</head>

<body>
    <!-- Background Effects -->
    <div class="bg-gradient"></div>
    <div class="bg-grid"></div>

    <!-- Navigation -->
    <nav class="navbar" id="navbar">
        <div class="container nav-content">
            <a href="index.html" class="logo">
                <img src="images/logo2.png" alt="InsightMatch" class="logo-image">
                <div class="logo-text">
                    <span>InsightMatch</span>
                    <span>by OpenBrain</span>
                </div>
            </a>
            
            <div class="nav-links">
                <a href="index.html#how-it-works">프로세스</a>
                <a href="index.html#diagnosis">AI 진단</a>
                <a href="index.html#faq">FAQ</a>
                <a href="blog.html">블로그</a>
            </div>
            
            <div class="nav-actions" id="nav-actions">
                <a href="login.html" class="btn btn-ghost">로그인</a>
                <a href="index.html#diagnosis" class="btn btn-primary">무료 진단 시작</a>
            </div>
            
            <!-- Mobile Menu Button -->
            <button class="mobile-menu-btn" id="mobile-menu-btn" aria-label="메뉴 열기">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>
    
    <!-- Mobile Navigation -->
    <div class="mobile-nav" id="mobile-nav">
        <a href="index.html#how-it-works" onclick="closeMobileMenu()">프로세스</a>
        <a href="index.html#diagnosis" onclick="closeMobileMenu()">AI 진단</a>
        <a href="index.html#faq" onclick="closeMobileMenu()">FAQ</a>
        <a href="blog.html">블로그</a>
        <div class="nav-divider"></div>
        <div id="mobile-nav-actions">
            <a href="login.html" class="btn btn-secondary">로그인</a>
            <a href="index.html#diagnosis" class="btn btn-primary" onclick="closeMobileMenu()">무료 진단 시작</a>
        </div>
    </div>

    <!-- Profile Container -->
    <div class="container profile-container">
        <!-- Back Link -->
        <a href="javascript:history.back()" class="back-link">
            <i data-lucide="arrow-left" style="width: 18px; height: 18px;"></i>
            돌아가기
        </a>
        
        <!-- Loading State -->
        <div id="profile-loading" class="profile-loading">
            <div class="loading-spinner" style="margin: 0 auto 16px;"></div>
            <p style="color: var(--text-muted);">프로필을 불러오는 중...</p>
        </div>
        
        <!-- Profile Content (Hidden until loaded) -->
        <div id="profile-content" class="profile-layout" style="display: none;">
            <!-- Main Content -->
            <div class="profile-main">
                <!-- Profile Header -->
                <div class="profile-header fade-in-up">
                    <div class="profile-avatar-large" id="profile-avatar">-</div>
                    <div class="profile-info">
                        <h1 class="profile-name">
                            <span id="profile-name">컨설턴트 이름</span>
                            <span id="profile-badge"></span>
                        </h1>
                        <p class="profile-specialty" id="profile-specialty">전문 분야</p>
                        <div class="profile-stats">
                            <div class="profile-stat">
                                <i data-lucide="briefcase" style="width: 18px; height: 18px;"></i>
                                <span id="profile-experience">경력 정보</span>
                            </div>
                            <div class="profile-stat">
                                <i data-lucide="star" style="width: 18px; height: 18px;"></i>
                                <span id="profile-rating">평점</span>
                            </div>
                            <div class="profile-stat">
                                <i data-lucide="message-square" style="width: 18px; height: 18px;"></i>
                                <span id="profile-reviews">리뷰</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Trust Score Section -->
                <div class="profile-section fade-in-up">
                    <h3 class="profile-section-title">
                        <i data-lucide="shield-check" style="width: 20px; height: 20px;"></i>
                        신뢰 점수
                    </h3>
                    <div style="display: flex; align-items: center; gap: 20px;">
                        <div style="font-size: 3rem; font-weight: 800; color: var(--primary);" id="trust-score-value">0</div>
                        <div style="flex: 1;">
                            <div class="trust-score-bar" style="height: 12px; border-radius: 6px;">
                                <div class="trust-score-fill" id="trust-score-bar" style="width: 0%; height: 100%; border-radius: 6px;"></div>
                            </div>
                            <p style="margin-top: 8px; font-size: 0.85rem; color: var(--text-muted);">
                                경력, 프로젝트 이력, 자격증, 고객 평가를 기반으로 산출된 종합 신뢰 점수입니다.
                            </p>
                        </div>
                    </div>
                </div>
                
                <!-- ISO Expertise Section -->
                <div class="profile-section fade-in-up">
                    <h3 class="profile-section-title">
                        <i data-lucide="award" style="width: 20px; height: 20px;"></i>
                        ISO 전문 규격
                    </h3>
                    <div class="iso-badge-list" id="iso-list">
                        <!-- ISO badges will be inserted here -->
                    </div>
                </div>
                
                <!-- Industry Experience Section -->
                <div class="profile-section fade-in-up">
                    <h3 class="profile-section-title">
                        <i data-lucide="building-2" style="width: 20px; height: 20px;"></i>
                        산업 경험
                    </h3>
                    <div class="industry-tag-list" id="industry-list">
                        <!-- Industry tags will be inserted here -->
                    </div>
                </div>
                
                <!-- Certifications Section -->
                <div class="profile-section fade-in-up" id="certifications-section" style="display: none;">
                    <h3 class="profile-section-title">
                        <i data-lucide="file-badge" style="width: 20px; height: 20px;"></i>
                        보유 자격
                    </h3>
                    <div class="certification-grid" id="certifications-list">
                        <!-- Certifications will be inserted here -->
                    </div>
                </div>
                
                <!-- Recent Projects Section -->
                <div class="profile-section fade-in-up" id="projects-section" style="display: none;">
                    <h3 class="profile-section-title">
                        <i data-lucide="folder-open" style="width: 20px; height: 20px;"></i>
                        최근 프로젝트
                    </h3>
                    <div class="project-list" id="projects-list">
                        <!-- Projects will be inserted here -->
                    </div>
                </div>
                
                <!-- Reviews Section -->
                <div class="profile-section fade-in-up" id="reviews-section">
                    <h3 class="profile-section-title">
                        <i data-lucide="message-circle" style="width: 20px; height: 20px;"></i>
                        고객 리뷰
                    </h3>
                    <div id="reviews-list">
                        <p style="color: var(--text-muted); text-align: center; padding: 40px;">
                            아직 등록된 리뷰가 없습니다.
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- Sidebar -->
            <div class="profile-sidebar">
                <div class="profile-contact-cta" style="position: sticky; top: 100px;">
                    <h3>이 전문가와 상담하기</h3>
                    <p>프로젝트 요구사항을 공유하고 맞춤형 제안을 받아보세요.</p>
                    
                    <div style="margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; font-size: 0.9rem; margin-bottom: 8px;">
                            <span style="color: var(--text-muted);">예상 응답 시간</span>
                            <span style="color: var(--primary); font-weight: 600;">24시간 이내</span>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary btn-lg" style="width: 100%; margin-bottom: 12px;">
                        <i data-lucide="send" style="width: 18px; height: 18px;"></i>
                        컨설팅 문의하기
                    </button>
                    
                    <a href="index.html?action=find-others#results-section" class="btn btn-secondary" style="width: 100%;">
                        <i data-lucide="sparkles" style="width: 18px; height: 18px;"></i>
                        AI로 다른 전문가 찾기
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Error State -->
        <div id="profile-error" style="display: none; text-align: center; padding: 80px 40px;">
            <i data-lucide="alert-circle" style="width: 64px; height: 64px; color: var(--error); margin-bottom: 16px;"></i>
            <h2 style="margin-bottom: 8px;">프로필을 찾을 수 없습니다</h2>
            <p style="color: var(--text-muted); margin-bottom: 24px;">요청하신 컨설턴트 정보를 불러올 수 없습니다.</p>
            <a href="index.html" class="btn btn-primary">홈으로 돌아가기</a>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <span>© 2025 OpenBrain Limited. All rights reserved.</span>
                <span>InsightMatch - AI-Powered ISO Consultant Matching</span>
            </div>
        </div>
    </footer>

    <script>
        lucide.createIcons();
        
        // Mobile Menu Toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileNav = document.getElementById('mobile-nav');
        
        function toggleMobileMenu() {
            mobileMenuBtn.classList.toggle('active');
            mobileNav.classList.toggle('active');
            document.body.style.overflow = mobileNav.classList.contains('active') ? 'hidden' : '';
        }
        
        function closeMobileMenu() {
            mobileMenuBtn.classList.remove('active');
            mobileNav.classList.remove('active');
            document.body.style.overflow = '';
        }
        
        mobileMenuBtn.addEventListener('click', toggleMobileMenu);
        
        window.addEventListener('resize', () => {
            if (window.innerWidth > 768) {
                closeMobileMenu();
            }
        });
        
        // Check login status and update navigation
        function updateNavigation() {
            const user = JSON.parse(localStorage.getItem('user'));
            const token = localStorage.getItem('token');
            const navActions = document.getElementById('nav-actions');
            const mobileNavActions = document.getElementById('mobile-nav-actions');
            
            if (user && token) {
                navActions.innerHTML = `
                    <a href="dashboard.html" class="btn btn-ghost">
                        <i data-lucide="layout-dashboard" style="width: 18px; height: 18px;"></i>
                        대시보드
                    </a>
                    <span style="color: var(--primary); font-weight: 500;">${user.name}님</span>
                    <button onclick="logout()" class="btn btn-ghost">
                        <i data-lucide="log-out" style="width: 18px; height: 18px;"></i>
                        로그아웃
                    </button>
                `;
                mobileNavActions.innerHTML = `
                    <a href="dashboard.html" class="btn btn-secondary" onclick="closeMobileMenu()">대시보드</a>
                    <button onclick="logout(); closeMobileMenu();" class="btn btn-ghost" style="width: 100%;">로그아웃</button>
                `;
                lucide.createIcons();
            }
        }
        
        function logout() {
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            updateNavigation();
        }
        
        updateNavigation();
        
        // Get consultant ID from URL
        const urlParams = new URLSearchParams(window.location.search);
        const consultantId = urlParams.get('id');
        
        // Fetch and display consultant profile
        async function loadProfile() {
            if (!consultantId) {
                showError();
                return;
            }
            
            try {
                const response = await fetch(`/api/consultants/${consultantId}`);
                
                if (!response.ok) {
                    throw new Error('Profile not found');
                }
                
                const consultant = await response.json();
                displayProfile(consultant);
            } catch (error) {
                console.error('Error loading profile:', error);
                showError();
            }
        }
        
        function displayProfile(c) {
            // Hide loading, show content
            document.getElementById('profile-loading').style.display = 'none';
            document.getElementById('profile-content').style.display = 'grid';
            
            // Update title
            document.title = `${c.name} - InsightMatch 컨설턴트`;
            
            // Basic Info
            document.getElementById('profile-avatar').textContent = c.avatar || c.name[0];
            document.getElementById('profile-name').textContent = c.name;
            document.getElementById('profile-specialty').textContent = `${c.specialty || '종합'} 전문`;
            document.getElementById('profile-experience').textContent = `경력 ${c.experience || '정보없음'}`;
            document.getElementById('profile-rating').textContent = `평점 ${c.rating || '-'}점`;
            document.getElementById('profile-reviews').textContent = `리뷰 ${c.reviews || 0}개`;
            
            // Verified Badge
            const badgeEl = document.getElementById('profile-badge');
            if (c.verified) {
                badgeEl.innerHTML = `
                    <span class="verified-badge-large">
                        <i data-lucide="badge-check" style="width: 18px; height: 18px;"></i>
                        검증된 전문가
                    </span>
                `;
            } else {
                badgeEl.innerHTML = `
                    <span class="unverified-badge" style="padding: 6px 14px; font-size: 0.85rem;">
                        <i data-lucide="clock" style="width: 14px; height: 14px;"></i>
                        검토 중
                    </span>
                `;
            }
            
            // Trust Score
            const trustScore = c.trustScore || 50;
            document.getElementById('trust-score-value').textContent = trustScore;
            document.getElementById('trust-score-bar').style.width = trustScore + '%';
            
            // ISO Experience
            const isoList = document.getElementById('iso-list');
            const isoExp = c.isoExperience || {};
            if (Object.keys(isoExp).length > 0) {
                isoList.innerHTML = Object.entries(isoExp).map(([code, role]) => `
                    <span class="iso-badge">
                        <i data-lucide="award" style="width: 16px; height: 16px;"></i>
                        ISO ${code}
                        ${role ? `<small style="opacity: 0.7;">(${role})</small>` : ''}
                    </span>
                `).join('');
            } else {
                isoList.innerHTML = '<p style="color: var(--text-muted);">등록된 ISO 규격이 없습니다.</p>';
            }
            
            // Industry Experience
            const industryList = document.getElementById('industry-list');
            const industries = c.industryExperience || [];
            if (industries.length > 0) {
                industryList.innerHTML = industries.map(ind => `
                    <span class="industry-tag">${translateIndustry(ind)}</span>
                `).join('');
            } else {
                industryList.innerHTML = '<p style="color: var(--text-muted);">등록된 산업 경험이 없습니다.</p>';
            }
            
            // Certifications
            const certs = c.detailedCertifications || [];
            if (certs.length > 0) {
                document.getElementById('certifications-section').style.display = 'block';
                document.getElementById('certifications-list').innerHTML = certs.map(cert => `
                    <div class="certification-item">
                        <i data-lucide="file-badge" style="width: 20px; height: 20px;"></i>
                        <span>${cert}</span>
                    </div>
                `).join('');
            }
            
            // Recent Projects
            const projects = c.recentProjects || [];
            if (projects.length > 0) {
                document.getElementById('projects-section').style.display = 'block';
                document.getElementById('projects-list').innerHTML = projects.map(proj => `
                    <div class="project-item">
                        <h4>${proj.title || proj}</h4>
                        ${proj.description ? `<p>${proj.description}</p>` : ''}
                    </div>
                `).join('');
            }
            
            // Re-initialize icons
            lucide.createIcons();
        }
        
        function translateIndustry(industry) {
            const translations = {
                'IT/Software': 'IT/소프트웨어',
                'Manufacturing': '제조/생산',
                'Construction': '건설/토목',
                'Chemical': '화학/에너지',
                'Automotive': '자동차/부품',
                'Medical': '의료/바이오',
                'Service': '서비스/유통',
                'Public': '공공기관',
                'IT': 'IT/소프트웨어'
            };
            return translations[industry] || industry;
        }
        
        function showError() {
            document.getElementById('profile-loading').style.display = 'none';
            document.getElementById('profile-error').style.display = 'block';
            lucide.createIcons();
        }
        
        // Load profile on page load
        loadProfile();
        
        // Navbar scroll effect
        window.addEventListener('scroll', () => {
            const navbar = document.getElementById('navbar');
            if (window.scrollY > 50) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
        });
    </script>
</body>

</html>

